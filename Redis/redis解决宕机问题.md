### 缓存雪崩

缓存是为了提高数据读取性能的, 缓存不可用或者缓存数据丢失不会影响到应用程序的处理-----应用程序可以直接从数据库中获取数据.随着业务的发展, 缓存会承担大部分数据访问的压力, 所以当缓存服务崩溃时, 数据库会因为完全不能承受如此大的压力而宕机, 导致整个网站不可用. 这就叫做缓存雪崩.出现缓存服务器宕机, 不能简单的通过重启缓存服务器或者数据库服务器, 因为重启之后缓存中数据加载还需要一段时间, 在这段时间内所有的高并发流量请求还是会落到数据库上, 数据库立马被新的流量打死.
缓存雪崩解决方案如下:

1. 采用分布式缓存集群的方式, 提高缓存的可用性. 当一台缓存服务器宕机时, 只有部分缓存数据丢失, 重新从数据库去查询这部分数据并不会对数据库造成太大的负载. 避免全盘崩溃.
2.  考虑一种极端的情况, 如果有缓存集群中大部分的服务器都挂了, 那么落到数据库上的请求足以将数据库打死. 使用本地缓存. 用户发送一个请求过来时, 先查本地缓存, 如果没有查到, 再查redis, 如果缓存中没有, 再查数据库, 并回填到本地缓存和redis中.
限流 & 降级. 避免MySQL被打死. 限流就是可以设置每秒的请求数, 只有部分不会对数据库造成崩溃的请求数量可以请求到数据库, 剩余的请求可以通过降级, 返回一些默认值或者友情提示或者空白值.好处就是数据库绝对不会挂掉. 限流确保每秒只有限定的请求数可以访问到数据库. 只要数据库没有挂掉, 系统就是可用的, 还可以处理部分用户的请求. 对用户来说, 可能就是点击几次刷不出来页面.
3. Redis持久化. 一旦重新启动缓存服务器, 就自动从磁盘上加载数据, 快速恢复缓存数据.

